!function t(e,s,a){function i(n,c){if(!s[n]){if(!e[n]){var o="function"==typeof require&&require;if(!c&&o)return o(n,!0);if(r)return r(n,!0);var l=new Error("Cannot find module '"+n+"'");throw l.code="MODULE_NOT_FOUND",l}var u=s[n]={exports:{}};e[n][0].call(u.exports,(function(t){return i(e[n][1][t]||t)}),u,u.exports,t,e,s,a)}return s[n].exports}for(var r="function"==typeof require&&require,n=0;n<a.length;n++)i(a[n]);return i}({1:[function(t,e,s){
/*!
  Copyright (c) 2018 Jed Watson.
  Licensed under the MIT License (MIT), see
  http://jedwatson.github.io/classnames
*/
!function(){"use strict";var t={}.hasOwnProperty;function s(){for(var e=[],a=0;a<arguments.length;a++){var i=arguments[a];if(i){var r=typeof i;if("string"===r||"number"===r)e.push(i);else if(Array.isArray(i)){if(i.length){var n=s.apply(null,i);n&&e.push(n)}}else if("object"===r)if(i.toString===Object.prototype.toString)for(var c in i)t.call(i,c)&&i[c]&&e.push(c);else e.push(i.toString())}}return e.join(" ")}void 0!==e&&e.exports?(s.default=s,e.exports=s):"function"==typeof define&&"object"==typeof define.amd&&define.amd?define("classnames",[],(function(){return s})):window.classNames=s}()},{}],2:[function(t,e,s){e.exports={TasksCreation:class{constructor(){$("#task-creation-form").submit(t=>{t.preventDefault(),this._addTask()})}_addTask(){WAIT_SCREEN.enable();let t=new FormData($("#task-creation-form")[0]);$.ajax({url:URLS.create_task,data:JSON.stringify(Object.fromEntries(t.entries())),type:"POST",contentType:"application/json"}).done(t=>{$(document).trigger({type:"addTask",taskData:t})}).fail((t,e,s)=>{console.log("jqXHR",t)}).always(()=>{WAIT_SCREEN.disable()})}}}},{}],3:[function(t,e,s){const a=t("classnames");class i extends React.Component{constructor(t){super(t),this.state={opened:!1}}get items(){return[]}get openFunction(){return t=>{this.setState({opened:!0}),this.openAdditionalFunction(t)}}get openAdditionalFunction(){return t=>{}}get closeFunction(){return t=>{this.setState({opened:!1}),this.closeAdditionalFunction(t)}}get closeAdditionalFunction(){return t=>{}}render(){let t=a("dialog-window",{"dialog-window-open":this.state.opened});return React.createElement("div",{className:t,onClick:this.closeFunction},React.createElement("div",{className:"dialog-window-content",onClick:t=>{t.stopPropagation()}},this.items))}}e.exports={BaseDialogComponent:i}},{classnames:1}],4:[function(t,e,s){const a=t("classnames"),{BaseDialogComponent:i}=t("../base.jsx");e.exports={StatusChangingDialog:class extends i{constructor(t){super(t),this._taskItem=null,$(document).on("changeStatusStart",this.openFunction)}get items(){return Object.entries(CHOISES.task.status).map(([t,e])=>{let s=a("tasks-stack-change-status-dialog-item","tasks-stack-item-status","tasks-stack-item-status-"+t.toLowerCase());return React.createElement("div",{className:s,onClick:e=>{this._changeValue(t)},key:t},e)})}get openAdditionalFunction(){return t=>{this._taskItem=t.taskItem}}get closeAdditionalFunction(){return t=>{this._taskItem=null}}_changeValue(t){this._taskItem&&(WAIT_SCREEN.enable(),$.ajax({url:URLS.update_task.replace(/\d+\/$/,this._taskItem.id+"/"),data:JSON.stringify({status:t}),type:"PATCH",contentType:"application/json"}).done(e=>{this._taskItem.setState({status:t})}).fail((t,e,s)=>{console.log("jqXHR",t)}).always(()=>{this._taskItem=null,WAIT_SCREEN.disable()}),this.setState({opened:!1}))}}}},{"../base.jsx":3,classnames:1}],5:[function(t,e,s){const{BaseDialogComponent:a}=t("../base.jsx");e.exports={BaseFilterDialog:class extends a{static FILTER_NAME=null;static FILTER_EVENT_NAME=null;constructor(t){super(t),this._entries=this._getEntries(t.choices),this.state={...this.state,activeValues:Object.keys(t.choices)},$(document).on(this.constructor.FILTER_EVENT_NAME,this.openFunction)}get openAdditionalFunction(){return t=>{this.setState({activeValues:t.activeValues})}}get items(){return this._entries.map(([t,e])=>{let s=`filter-checkbox-${this.constructor.FILTER_NAME}-${t.toString().toLowerCase()}`;return React.createElement("div",{key:t},React.createElement("input",{type:"checkbox",id:s,value:t,onChange:this._getItemChangeHandler(s,t),checked:this.state.activeValues.includes(t),className:"styled-checkbox"}),React.createElement("label",{htmlFor:s}),React.createElement("div",{className:this._getItemClasses(t),onClick:this._getItemClickHandler(s)},e))})}_getEntries(t){return Object.entries(t)}_getItemClasses(t){}_getItemClickHandler(t){return e=>{$(`#${t} + label`).click()}}_getItemChangeHandler(t,e){return t=>{t.target.checked?this.state.activeValues.includes(e)||this.setState((t,s)=>{let a=[...t.activeValues,e];return this._trigerSetFilterEvent(a),{activeValues:a}}):this.setState((t,s)=>{let a=t.activeValues.filter(t=>t!=e);return this._trigerSetFilterEvent(a),{activeValues:a}})}}_trigerSetFilterEvent(t){$(document).trigger({type:"setFilter",name:this.constructor.FILTER_NAME,values:t})}}}},{"../base.jsx":3}],6:[function(t,e,s){const a=t("classnames"),{BaseFilterDialog:i}=t("./base.jsx");e.exports={PriorityFilterDialog:class extends i{static FILTER_NAME="priority";static FILTER_EVENT_NAME="filterPriorityStart";_getEntries(t){return Object.entries(t).reverse().map(([t,e])=>[parseInt(t),e])}_getItemClasses(t){return a("tasks-stack-filter-priority-dialog-item","tasks-stack-item-priority-"+t)}}}},{"./base.jsx":5,classnames:1}],7:[function(t,e,s){const a=t("classnames"),{BaseFilterDialog:i}=t("./base.jsx");e.exports={StatusFilterDialog:class extends i{static FILTER_NAME="status";static FILTER_EVENT_NAME="filterStatusStart";_getItemClasses(t){return a("tasks-stack-filter-status-dialog-item","tasks-stack-item-status","tasks-stack-item-status-"+t.toLowerCase())}}}},{"./base.jsx":5,classnames:1}],8:[function(t,e,s){const{Stack:a}=t("./stack/main.jsx"),{StatusChangingDialog:i}=t("./dialog/changing/status.jsx"),{StatusFilterDialog:r}=t("./dialog/filter/status.jsx"),{PriorityFilterDialog:n}=t("./dialog/filter/priority.jsx"),{TasksCreation:c}=t("./creation");window.CHOISES=JSON.parse(RAW_CHOISES),window.URLS=JSON.parse(RAW_URLS),window.WAIT_SCREEN={enabled:!1,enable(){$("#wait-screen").addClass("wait-screen-enabled"),this.enabled=!0},disable(){$("#wait-screen").removeClass("wait-screen-enabled"),this.enabled=!1}},$.ajaxSetup({beforeSend:function(t,e){if(/^(GET|HEAD|OPTIONS|TRACE)$/.test(e.type)||this.crossDomain)return;let s=document.cookie.split("csrftoken=")[1].split("; ")[0];t.setRequestHeader("X-CSRFToken",s)}}),$(document).ready((function(){new c,ReactDOM.render(React.createElement(a,null),document.getElementById("tasks-stack-items")),ReactDOM.render(React.createElement(i,null),document.getElementById("change-status-dialog")),ReactDOM.render(React.createElement(r,{choices:CHOISES.task.status}),document.getElementById("filter-status-dialog")),ReactDOM.render(React.createElement(n,{choices:CHOISES.task.priority}),document.getElementById("filter-priority-dialog"))}))},{"./creation":2,"./dialog/changing/status.jsx":4,"./dialog/filter/priority.jsx":6,"./dialog/filter/status.jsx":7,"./stack/main.jsx":13}],9:[function(t,e,s){const{Priority:a}=t("./priority.jsx"),{Meaning:i}=t("./meaning.jsx"),{Status:r}=t("./status.jsx");class n extends React.Component{constructor(t){super(t),this.id=t.taskData.id,this.state={priority:t.priority,name:t.name,description:t.description,status:t.status}}render(){return React.createElement("div",{className:"tasks-stack-row"},React.createElement(a,{value:this.state.priority}),React.createElement(i,{name:this.state.name,description:this.state.description}),React.createElement(r,{value:this.state.status,taskItem:this}))}}e.exports={Item:n}},{"./meaning.jsx":10,"./priority.jsx":11,"./status.jsx":12}],10:[function(t,e,s){const a=t("classnames");class i extends React.Component{constructor(t){super(t),this.state={value:t.value}}render(){return React.createElement("div",{className:"tasks-stack-cell-meaning-name"},"this.state.value")}}class r extends React.Component{constructor(t){super(t),this.state={value:t.value}}get showed(){return this.state.value&&""!=this.state.value}render(){let t=a("tasks-stack-cell-meaning-description",{"tasks-stack-cell-meaning-description-show":this.showed});return React.createElement("div",{className:t,title:this.showed?this.state.value:""},React.createElement("div",null,"i"))}}class n extends React.Component{constructor(t){super(t),this.state={name:t.name,decsription:t.decsription}}render(){return React.createElement("div",{className:"tasks-stack-cell tasks-stack-cell-meaning"},React.createElement("div",{className:"tasks-stack-cell-meaning-wrapper"},React.createElement(i,{value:this.state.name}),React.createElement(r,{value:this.state.decsription})))}}e.exports={Meaning:n}},{classnames:1}],11:[function(t,e,s){const a=t("classnames");class i extends React.Component{constructor(t){super(t),this.state={value:t.value}}get value(){return this.state.value}set value(t){if(!Object.keys(CHOISES.task.priority).includes(t.toString()))throw Error(`Wrong task priority value "${t}".`);this.setState({value:t})}render(){let t=a("tasks-stack-cell","tasks-stack-cell-priority"),e=a("tasks-stack-item-priority","tasks-stack-item-priority-"+this.state.value);return React.createElement("div",{className:t},React.createElement("div",{className:e,title:CHOISES.task.priority[this.state.value]},this.items))}}e.exports={Priority:i}},{classnames:1}],12:[function(t,e,s){const a=t("classnames");class i extends React.Component{constructor(t){super(t),this._taskItem=t.taskItem,this.state={value:t.value}}render(){let t=a("tasks-stack-item-status","tasks-stack-item-status-"+value.toLowerCase());return React.createElement("div",{className:"tasks-stack-cell tasks-stack-cell-status"},React.createElement("div",{className:t,onClick:t=>{$(document).trigger({type:"changeStatusStart",taskItem:this._taskItem})}},CHOISES.task.status[this.state.value]))}}e.exports={Status:i}},{classnames:1}],13:[function(t,e,s){const{Item:a}=t("./item/main.jsx");class i extends React.Component{static FILTER_PRIORITY="priority";static FILTER_STATUS="status";static ALL_FILTERS=[i.FILTER_PRIORITY,i.ALL_FILTERS];constructor(t){super(t),this.state={items:[],filters:{[i.FILTER_PRIORITY]:Object.keys(CHOISES.task.priority).map(t=>parseInt(t)),[i.FILTER_STATUS]:Object.keys(CHOISES.task.status)}},this._addTaskHandler=t=>{this.setState((e,s)=>({items:[...e.items,t.taskData]}))},this._setFilterHandler=t=>{this._setFilter(t.name,t.values)},this._statusFilterHandler=t=>{$(document).trigger({type:"filterStatusStart",activeValues:this.state.filters[i.FILTER_STATUS]})},this._priorityFilterHandler=t=>{$(document).trigger({type:"filterPriorityStart",activeValues:this.state.filters[i.FILTER_PRIORITY]})},this._getTasksData()}get items(){return this._sort(this._filter(this.state.items))}componentDidMount(){$(document).on("addTask",this._addTaskHandler),$(document).on("setFilter",this._setFilterHandler),$("#tasks-stack-filter-status").on("click",this._statusFilterHandler),$("#tasks-stack-filter-priority").on("click",this._priorityFilterHandler)}componentWillUnmount(){$(document).off("addTask",this._addTaskHandler),$(document).off("setFilter",this._setFilterHandler),$("#tasks-stack-filter-status").off("click",this._statusFilterHandler),$("#tasks-stack-filter-priority").off("click",this._priorityFilterHandler)}render(){return React.createElement("div",null,this.items.map(t=>React.createElement(a,{taskData:t,key:t.id})))}_filter(t){for(let e of Object.keys(this.state.filters))t=t.filter(t=>this.state.filters[e].includes(t[e]));return t}_sort(t){return t.sort((t,e)=>t.priority>e.priority?-1:t.priority<e.priority?1:0)}_getTasksData(){$.ajax({url:URLS.user_tasks}).done(t=>{this.setState({items:t})}).fail((function(t,e,s){console.log("jqXHR",t)}))}_setFilter(t,e){if(!i.ALL_FILTERS.includes(t))throw Error(`Wrong stack item data name "${t}".`);if(!Array.isArray(e))throw Error("Values argument has to be an array.");this.setState({filters:e})}}e.exports={Stack:i}},{"./item/main.jsx":9}]},{},[8]);